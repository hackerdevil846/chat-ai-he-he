module.exports.config = {
    name: "daily",
    aliases: ["reward", "claim"],
    version: "2.0.0",
    author: "ğ´ğ‘ ğ‘–ğ‘“ ğ‘€ğ‘â„ğ‘šğ‘¢ğ‘‘",
    countDown: 5,
    role: 0,
    category: "economy",
    shortDescription: {
        en: "ğŸ’° ğ·ğ´ğ¼ğ¿ğ‘Œ ğ‘…ğ¸ğ‘Šğ´ğ‘…ğ· ğ‘†ğ‘Œğ‘†ğ‘‡ğ¸ğ‘€ | ğºğ‘’ğ‘¡ 19ğµ+ ğ¶ğ‘œğ‘–ğ‘›ğ‘  ğ¸ğ‘£ğ‘’ğ‘Ÿğ‘¦ 12 ğ»ğ‘œğ‘¢ğ‘Ÿğ‘ "
    },
    longDescription: {
        en: "ğ¶ğ‘™ğ‘ğ‘–ğ‘š ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ‘‘ğ‘ğ‘–ğ‘™ğ‘¦ ğ‘Ÿğ‘’ğ‘¤ğ‘ğ‘Ÿğ‘‘ ğ‘œğ‘“ 19ğµ+ ğ‘ğ‘œğ‘–ğ‘›ğ‘  ğ‘’ğ‘£ğ‘’ğ‘Ÿğ‘¦ 12 â„ğ‘œğ‘¢ğ‘Ÿğ‘ "
    },
    guide: {
        en: "{p}daily"
    },
    envConfig: {
        cooldownTime: 43200000,
        rewardCoin: 19011310000
    }
};

module.exports.languages = {
    "en": {
        "cooldown": "ğŸ•’ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n      ğ·ğ´ğ¼ğ¿ğ‘Œ ğ¶ğ‘‚ğ‘‚ğ¿ğ·ğ‘‚ğ‘Šğ‘\nâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nâ³ ğ‘…ğ‘’ğ‘šğ‘ğ‘–ğ‘›ğ‘–ğ‘›ğ‘” ğ‘‡ğ‘–ğ‘šğ‘’:\n   â‡ %1ğ— %2á´ %3ğ˜´\n\nğŸ“Œ ğ‘ğ‘œğ‘¡ğ‘’: ğ‘Œğ‘œğ‘¢ ğ‘ğ‘ğ‘› ğ‘ğ‘™ğ‘ğ‘–ğ‘š ğ‘ğ‘”ğ‘ğ‘–ğ‘› ğ‘–ğ‘› 12 â„ğ‘œğ‘¢ğ‘Ÿğ‘ ",
        "rewarded": "âœ¨ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n       ğ‘…ğ¸ğ‘Šğ´ğ‘…ğ· ğ¶ğ¿ğ´ğ¼ğ‘€ğ¸ğ·!\nâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nğŸ’° ğ´ğ‘šğ‘œğ‘¢ğ‘›ğ‘¡ ğ‘…ğ‘’ğ‘ğ‘’ğ‘–ğ‘£ğ‘’ğ‘‘:\n   â‡ %1 ğ–¢ğ—ˆğ—‚ğ—‡ğ—Œ\n\nğŸ¯ ğ‘ğ‘’ğ‘¥ğ‘¡ ğ‘…ğ‘’ğ‘¤ğ‘ğ‘Ÿğ‘‘ ğ‘–ğ‘›:\n   â‡ 12 ğ»ğ‘œğ‘¢ğ‘Ÿğ‘ \n\nğŸ’¡ ğ‘‡ğ‘–ğ‘: ğ¶ğ‘œğ‘šğ‘’ ğ‘ğ‘ğ‘ğ‘˜ ğ‘‘ğ‘ğ‘–ğ‘™ğ‘¦ ğ‘“ğ‘œğ‘Ÿ ğ‘šğ‘œğ‘Ÿğ‘’ ğ‘Ÿğ‘’ğ‘¤ğ‘ğ‘Ÿğ‘‘ğ‘ !",
        "firstTime": "ğŸŠ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n     ğ¹ğ¼ğ‘…ğ‘†ğ‘‡ ğ‘‡ğ¼ğ‘€ğ¸ ğµğ‘‚ğ‘ğ‘ˆğ‘†!\nâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nâœ¨ ğ‘Šğ‘’ğ‘™ğ‘ğ‘œğ‘šğ‘’ ğ‘¡ğ‘œ ğ·ğ‘ğ‘–ğ‘™ğ‘¦ ğ‘…ğ‘’ğ‘¤ğ‘ğ‘Ÿğ‘‘ğ‘ !\n\nğŸ’° ğ´ğ‘šğ‘œğ‘¢ğ‘›ğ‘¡ ğ‘…ğ‘’ğ‘ğ‘’ğ‘–ğ‘£ğ‘’ğ‘‘:\n   â‡ %1 ğ–¢ğ—ˆğ—‚ğ—‡ğ—Œ\n\nğŸ¯ ğ‘ğ‘’ğ‘¥ğ‘¡ ğ‘…ğ‘’ğ‘¤ğ‘ğ‘Ÿğ‘‘ ğ‘–ğ‘›:\n   â‡ 12 ğ»ğ‘œğ‘¢ğ‘Ÿğ‘ \n\nğŸ’¡ ğ‘‡ğ‘–ğ‘: ğ¶ğ‘™ğ‘ğ‘–ğ‘š ğ‘‘ğ‘ğ‘–ğ‘™ğ‘¦ ğ‘¡ğ‘œ ğ‘ğ‘¢ğ‘–ğ‘™ğ‘‘ ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ‘“ğ‘œğ‘Ÿğ‘¡ğ‘¢ğ‘›ğ‘’!"
    }
};

module.exports.onStart = async function({ event, api, Currencies, getText }) {
    try {
        const { cooldownTime, rewardCoin } = this.config.envConfig;
        const { senderID, threadID, messageID } = event;

        const userData = await Currencies.getData(senderID);
        const data = userData.data || {};
        
        // Check if user has claimed before
        const isFirstTime = !data.hasClaimedDaily;
        
        if (data.dailyCoolDown && Date.now() - data.dailyCoolDown < cooldownTime) {
            const remaining = cooldownTime - (Date.now() - data.dailyCoolDown);
            const hours = Math.floor(remaining / 3600000);
            const minutes = Math.floor((remaining % 3600000) / 60000);
            const seconds = Math.floor((remaining % 60000) / 1000);
            
            return api.sendMessage(
                getText("cooldown", hours, minutes, seconds), 
                threadID, 
                messageID
            );
        }

        // Give bonus for first time claimers
        const actualReward = isFirstTime ? Math.floor(rewardCoin * 1.5) : rewardCoin;
        
        await Currencies.increaseMoney(senderID, actualReward);
        data.dailyCoolDown = Date.now();
        data.hasClaimedDaily = true;
        await Currencies.setData(senderID, { data });

        const formattedCoin = actualReward.toLocaleString('en-US');
        
        return api.sendMessage(
            getText(isFirstTime ? "firstTime" : "rewarded", formattedCoin), 
            threadID, 
            messageID
        );

    } catch (error) {
        console.error("ğ·ğ‘ğ‘–ğ‘™ğ‘¦ ğ‘…ğ‘’ğ‘¤ğ‘ğ‘Ÿğ‘‘ ğ¸ğ‘Ÿğ‘Ÿğ‘œğ‘Ÿ:", error);
        api.sendMessage("âŒ ğ´ğ‘› ğ‘’ğ‘Ÿğ‘Ÿğ‘œğ‘Ÿ ğ‘œğ‘ğ‘ğ‘¢ğ‘Ÿğ‘Ÿğ‘’ğ‘‘ ğ‘¤â„ğ‘–ğ‘™ğ‘’ ğ‘ğ‘Ÿğ‘œğ‘ğ‘’ğ‘ ğ‘ ğ‘–ğ‘›ğ‘” ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ‘‘ğ‘ğ‘–ğ‘™ğ‘¦ ğ‘Ÿğ‘’ğ‘¤ğ‘ğ‘Ÿğ‘‘.", event.threadID, event.messageID);
    }
};
